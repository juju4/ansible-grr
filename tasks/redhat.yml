---
## https://groups.google.com/forum/#!searchin/grr-users/redhat/grr-users/DFuSy8VpCmk/hKQgfTn5BAAJ
## https://github.com/google/grr/blob/master/vagrant/install_linux.sh

- name: yum | grr-server dependencies packages install
  yum: name={{item}} state=present update_cache=yes
  with_items: "{{ grrserver_pkgÂ }}"

- lineinfile: dest=/etc/ld.so.conf.d/libc.conf line='/usr/local/lib' create=yes

- selinux: state=disabled

## build rpm ?
## https://github.com/google/grr/blob/master/config/centos/grr.spec.in

- name: yum | Mysql datastore dependencies
  yum: name={{item}} state=present
  with_items:
    - mariadb-server
    - MySQL-python
  when: grr_datastore is defined and grr_datastore == 'MysqlAdvanced' and grr_datastore_mysql_host == 'localhost'

- name: Redhat | Ensure Mysql/Mariadb is running and enabled on boot.
  service: name=mariadb state=started enabled=yes
  when: grr_datastore is defined and grr_datastore == 'MysqlAdvanced' and grr_datastore_mysql_host == 'localhost'

#- include: source-build.yml
- include: grr-pip.yml

